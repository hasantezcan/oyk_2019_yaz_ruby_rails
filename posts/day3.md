#### `Özgür Yazılım Yaz Kampı '19`

### `Ruby on Rails - GÜN 3 - 2019.07.21`

---

## Doruk Fişek - Özgür Bir Yazılımcı Olmak

Sunum: [**Özgür Bir Yazılımcı Olmak**](https://topluluk.ozguryazilim.com.tr/wp-content/sunumlar/ozguryazilim-sunumlar/ozgur-bir-yazilimci-olmak.html#1)

> Özgür yazılın A.Ş'nin diğer sunumları:
https://topluluk.ozguryazilim.com.tr/sunumlar/

- Kodu biz anlayalım diye yazıyoruz. Zaten bilgisayarın anladığı sıfır, bir. Yani **insan okunabilirliği** ***fazla*** olan kod makbuldür.

#### Yazılım nasıl özgür olur?
> Özgür yazılım olma şartları.

- **Kullanma hakkı**
	- Günlük hayatan bir örnek vermek gerekirse; Şu kahveden sadece ve sadece Kuzey ve Güney Amerika ülkeleri içecek desek ortalık karışmaz mı? Neden biz içemiyoruz bizim başımız kel mi demez miyiz? deriz. Buna karşı çıkarız. Fakat öteyandan bu durum bir yazılım için geçerli olduğunda yani şu yazılımı Suriyede, Filistinde ve Irakta yaşayanlar kulanamaz! Yine de kulanmak ister misin? dendiğinde -hani şu next next deyip geçtiğimiz yazılım lisanları kısımında- "ya ne olacak!" deyip kabul ediyoruz. Aslında somut bir örnek dahilinde kabul etmeyeceğimiz bir durmu sanal yazılım dünyasnda kabul etmiş oluyoruz.
- **Çoğaltma, dağıtma ve paylaşma hakkı**
	- İnsanlar sosyal yaşamlarında paylaşmayı çok doğal görürken iş sanal bir şeyi paylaşmaya geldiğinde biraz çekingen oluyorlar. Mesela iki arkadaşdan birinin yemeğinin olmadığını düşünün. Böyle bir durumda yemeği olan, hiç düşünmeden yemeğinin yarısını öbürüyle paylaşabiliyor ve bu durmu kendi yararına olacak bir şeyin yarısını kaybedeceğini bile bile yapıyor.

	- Fakat şimdi bu iki arkdaşdan birinde çok kulanışlı ve çok faydalı bir yazılımın olduğunu düşünelim. Bu durumda diğeri, arkadaşından bu yazılımı istediğinde bu sefer paylaşmak istemeyecek türlü mazertler uydurarak bu durumdan kurtulmaaya çalışacak. Ve aslında bu yazılımı paylaşsa kendi kulanımında herhangi bir eksilme olmaycak. Aksine arkadaşına yazılımı vermediği için arakaşı ile arasıdaki ilişki sarsılmış olcak ve bu durumdan zararlı çıkacak.

	- Bir örnekle de **çoğatlma ve dağıtma hakkına** değinecek olursak. Bir fırıncı düşünün adı Özgür Fırın olsun. Bu Özgür Fırın bir ekmek makine yapmış olsun ve bu makine tek bir ekmeği sınırsız sayıda çoğaltma ve ekmeği istediği yere ışınlama yeteneği versin bizim Ögür Fırın'a. Nekadar mükemmel değil mi? Şuan dünyadaki açlığa son verdik. Ve bunu yaparken hiçbir hammadde yemiyor ve Ögür Fırından bir şey eksiltmiyor.

	Evet.. Böyle bir durumda Özgür Fırının tüm dünyadaki açılığa çözüm olacakğı herkese bedava ekemek vereciğini ve artık kimsenin açlıktan ölmediği bir dünya yaratacağını düşünürsünüz değil mi? Bunun aksine Özgür Fırını artık tek el ben oldum. Ekemk 1 değil 5 lira kimseye de bedava ekemk yok dedi! Ne yaparsınız? Sanırım duyarlı her insan bu adama karşı gelir ve bu bencilce ve insanlık dışı davranışa çok sinirlenir!

	Evet çok doğru fakat yine bu durum soyut yazılım dünyasında hiç de deminki örnekte olduğu gibi işlemiyor. Kimse çok karlı çalışan yazılımını bedava tüm dünyanın kulanımına açmıyor. Ve biz bu duruma deminki örnekte olduğı gibi sert bir gözle bakmıyoruz.

- Özetle gereçek hayatta **asla olmaz** dediğimiz şeylere yazılım dünyasında **"-he"** deyip geçiyoruz.

- **İnceleme hakkı**
	- Hatasız yazlım olmaz! Yazılım geliştirme bir süreçtir ve hatalar bulundukça giderilir. Bu iş böyle yürür.

	- Örneğin insanların geleceklerini belirleyen sınav sistemlerin kodu kapalı. Bir girdi alıp bir çıktı veren bu sistemlerin nasıl çalıştığını vatandaşların görebilmesi gerekir. Dediğimiz gibi hatasız yazılım olmaz. Belki de kodu yazanların göremediği fakat kodu açık olursa vatandaşların farkedebileceği hatarlar var. Böyle bir sistem olduğunda vatandaşın itaraz edebilceği bir hata olmacak. Zaten varsa da giderilmişi olacaktır.

- **Değiştirme ve Değiştirdiğini Dağıtma hakkı**
	- Bir Spor araba markası düşünün bunun iki modeli var ikisi de aynı özelliklere sahip sadece bir tanesi en çok 200km/h yaparken diğeri 400km/h hıza ulaşabiliyor. Ve bu hız farkının olmasına neden olan şey yanlızca bir vida. O vide olunca 400 yokken 200. Ben bu vidayı çok basit şekilde ürettim ve arabayı 400 bascak hale gitirdim. Çalışıyor  da ama YASAK! "Neden?" Çünkü üretici firma eğer 400 basamak istiyorsanız diğerinden 100 bin dolar daha pahalı bir üst modeli almanızı istiyor. Size aptağınız bu modifikasyonun yasal olmadığını söylüyor. Ne kdar saçma değil mi? Bu hakkın bize verilmesini ve diğer bu sorunu yaşan insanlarında derdine care olmak isteriz. İşte bu yüzdendir ki özgür  yazılım değiştirilebilir ve dağıtılabilir olmalıdır.

	- Peki bu değiştirme bazı sorunları da yanında getirmez mi?
		- Evet getirebilir. Mesela bilgisayarlarınızın wifi kartındaki frekanslarla oynarsınz ve bilmeden ya da bilerek birisin kalp pilini bozmuş olursunuz böyle bir durumda elde ettiğiniz sonuç bir yıkım olabilir. İşte bu yüzden de bu hata yaşanmasın diye wifi kartları üzerinde gelen bir kısımın kodaları açık değil bu sayede kimse frekansını değiştirip herhangi birisinin kalp pilinin bozulmasına sebep olamaz.


#### Özgür yazılım ve para ilişkisi?
> En popüler sorulardan biri!

- Özgür yazılımların servislerinden para kazanmak tavisye edilen para kazanma yöntemidir.

- Örnek vermek gerekirse, çöp atmak işlermi nedir? Hepimiz bu adımları biliriz değil mi? Nedir bunlar?
	- Çöp kutusuna çöp poşedini takarsın.
	- Çöpün dolmasını beklersin
	- Çöp poşedi dolar.
	- Dolan çöp poşedinin ağzını bağlarsın.
	- Çöp toplama saati geldiğinde.
	- Çöp poşedini apartman kapısı önüne getirirsin.
	- Evin toplu çöpüne çöpü bırakırsın.
	- Dön başa..

- Bunu siz yapabilirsiniz değil mi? Ya da bir yardımcı tutup tüm bu adımları belli bir ücret karşılığında onun yapmasını isteyebilirsiniz. İşte özgür yazlım hizmeti de bu örneğe yaklaşık şekilde veriliyor.

#### Özgür yazılım lisansları

- [**gnu.org/licenses**](https://www.gnu.org/licenses/licenses.html)

- **BSD - Herşey serbest lisans**
	- Open SSL bu lisans ile lisanslandığından Open SSL'e bir update geldiğinde tüm işletim sistemlerinde nerdeyse aynı vakitlerde update çıkar. Direk çıkan update'i sistemlerine gömerler.

**...**

**...**

**...**

### `SORULAR`

#### Özgür yazılımı şan şöhret kazanmak için kullanmak etik midir?

> Özgür yazılımları şan şöhret yapmak için kulanıp sonrasında kapalı kod yazan bir yerde işe girmek ne kadar etiktir?

- Bu kişinin bileceği işdir. Yapılabilir mi evet yapılır. Herkesin özgür yazılımı hayatına uyarlama şekli başkadır.

#### Benim özgür yazılımımı aldılar ve kendi kapalı kaynak kodunun içine yerleştirdi ben bunu nasıl farkedicem.

- Böyle durumlar için en çok kullanılan yönetm Easteregg yönetimidir. Bu yöntem kodunuzu içine belli girdiler verdiğnizde sadece sizin bildiğiniz çıktıalrın vermesini sağlayacak süpriz yumurtalardır.

- Bu duruma örnek olarak bir ara "man" programını 00.30 da çalıştırdığınızda size çıktı olarak şarkı sözü veriyordu. -Sonra bunu çözmüşler-

- Bu easteregglere web ansiklopedi sayfalarındaki reklamlar da örnek olarak gösterebilir. Eğer öğrenci bulduğu dökümanı hiç okumdan bastırırsa beraberinde sayfadaki reklamkarı da basmış oluyor. Ve ödevini layığı ile yapmadığını bize çıktıda gördüğümüz reklamlar ile kanıtlamış oluyor.

#### Özgür olarak geliştirdiğim bir projeye bir firma kendi yararı için yeni bir özellik yazmamı istedi ama bunun gizli olmasını istiyor. Bu iş nasıl olur?

- Öncelikle projenin lisansına göre değişir.

- Ama bu özelliği sadece müşterin için yapıp projenin o halini sadece müşterine dağıtırsın sonuçta bir kişiye de dağıtmış olsan özgür olur.

> NOT: Bu kısım biraz bana eksik geldi. Çünkü bu uygulama bizden çıktıktan sonra başkaları tarafından görülecek onlar istediğinde vermeğimizi varsayalım ki müşteri vermememizi ister. Bu durumda yazılımımız özgür olmaktan çıkmaz mı???  


---

## bundler

[**bundler.io**](https://bundler.io)

- Bundler Rails projemizde kulandığımız gem'leri kontrol etmek için kullanılan bir paket yöneticisidir. Ve aslında kendisi de bir "**gem**" dir.

- Rails projelerinde bulunan `gemfile.rb` de **bundler** tarafından oluşturulur.

> Öncelikle bundler gem'ini kuralım

```bash
gem install bundler
```

#### "`ufak bir uygulama`"

- İlk olarak `bundler_example` adında bir dizin oluşturalım

```bash
mkdir bundler_example
```

-  oluşturmuş olduğumuz dizine girelim

```bash
cd bundler_example
```

> bu noktada dizin içinde `ls -la` yazdığımızda herhangi bir dosya göremiyeceğiz, içi tamemen boş bir dizin.

- `bundle init` dediğimiz anda bizim için dizin içine `gemfile.rb` dosyasını oluşturur.

```bash
bundle init
```

bu noktadan sonra projeye herhangi bir `gem` eklemek istediğinizde `gemfile.rb` içine kurmak istediğinzi gem'i yazmanız yeterli.

**NOT:** Kurmak istediğinzi gem'in güncel ve versiyon belirtilmiş şekilde kurmak isterseniz **https://rubygems.org** üzerinden kurmak istediğiniz gem'i seçip ilgili gem'i projenize kurabilirsiniz.

<p align="center">
	<img alt="rack-gem" src="/img/day3/rack-gem.png" width="650">
</p>

- **rack** gem'ini gemfile.rb'ye ekleyelim.

```ruby
# frozen_string_literal: true

source "https://rubygems.org"

git_source(:github) {|repo_name| "https://github.com/#{repo_name}" }

# gem "rails"

gem "rack"
```

- Şimdi `bundle instal` diyeceğiz ve gemfile içindeki gemler kurulacaklar.

<p align="center">
	<img alt="bundle_install" src="/img/day3/bundle-install.png" width="800">
</p>

## Rack ile basit bir  uygulama sunucusu ayağa kaldırma örneği

Hali hazırda kurmuş olduğumuz rack gem'i zaten bu ammaç için kurulmuştu. Şimdi bunu nasıl yapacağımızdan bahsedicez. Öncelikle [rack.github.io](https://rack.github.io/)'a gidiyoruz. Zaten burada yapmamız gereken adımlar sıra sıra verilmiş ama biz yine de üstünden geçelim.

Zaten oluşturmuş olduğumuz bundler_example dosyasının içine girelim. Şu an sadece `Gemfile` ve `Gemfile.lock` dosyaları var.  

Henüz bir uygulamamız yok bu yüzden `app.rb` adında bir dosya oluşturalım.

```bash
$ touch app.rb
```
Uygulamamızı temsili şekilde oluşturmuş olduk. Şimdi ise rack konfigrasyonunu yapmamız gerek. Bunun iki yolu var. İlk yol direk uygulama dosyası içine gerekli implementasyonu yapmak. Yani direk app.rb içine bu kodu yapıştırmamız gerek..

```ruby
require 'rack'

app = Proc.new do |env|
    ['200', {'Content-Type' => 'text/html'}, ['First app.']]
end

Rack::Handler::WEBrick.run app
```

Web serverimiz bu noktada çalışabilir durumda.

```bash
$ ruby app.rb
[2019-08-14 16:21:38] INFO  WEBrick 1.4.2
[2019-08-14 16:21:38] INFO  ruby 2.6.3 (2019-04-16) [x86_64-linux]
[2019-08-14 16:21:38] INFO  WEBrick::HTTPServer#start: pid=21642 port=8080
127.0.0.1 - - [14/Aug/2019:16:21:40 +03] "GET / HTTP/1.1" 200 10
- -> /
```
<p align="center">
	<img alt="rack-first-app" src="/img/day3/rack-first-app.png" width="500">
</p>

Ya da `config.ru` adlı bir dosya oluşturup rack implementasyonunu buraya yapabilirsiniz.

```bash
$ touch config.ru
```

config.ru içine aşağıdaki betiği yazıyoruz.

```ruby
run Proc.new { |env| ['200', {'Content-Type' => 'text/html'}, ['get rack\'d']] }
```

Şimdi web serverimiz çalıştırmak için `rackup` çalıştırılabilirini kullanıcaz.

```bash
rackup config.ru

Puma starting in single mode...
* Version 4.0.1 (ruby 2.6.3-p62), codename: 4 Fast 4 Furious
* Min threads: 0, max threads: 16
* Environment: development
* Listening on tcp://localhost:9292
Use Ctrl-C to stop
::1 - - [14/Aug/2019:16:30:19 +0300] "GET / HTTP/1.1" 200 - 0.0009
```
**NOT:** rackup ile kaldırdığımız server PUMA ile çalışırken direk uygulama ile kaldırdığımız server WEBrick ile çalıştı. Bunun sebebi uygulama üzerinden çalıştırdığımız serverda özel olarak WEBrick ile çalışmasını söylememiz. Eğer direk app üzerinden çalışırken PUMA kullansın isteseydik. app.rb'yi şu şekilde düzenlememiz gerecekti.

```ruby
require 'rack'
require 'rack/handler/puma'


app = Proc.new do |env|
    ['200', {'Content-Type' => 'text/html'}, ['First app.']]
end

Rack::Handler::Puma.run app
```

ardından serveri çalıştırdığınızda PUMA ile çalışacağını göreceksiniz.

```bash
$ ruby app.rb

Puma starting in single mode...
* Version 4.0.1 (ruby 2.6.3-p62), codename: 4 Fast 4 Furious
* Min threads: 0, max threads: 16
* Environment: development
* Listening on tcp://0.0.0.0:9292
Use Ctrl-C to stop
::1 - - [14/Aug/2019:16:30:19 +0300] "GET / HTTP/1.1" 200 - 0.0009
```
<p align="center">
	<img alt="rack-first-app" src="/img/day3/rack-first-app-puma.png" width="500">
</p>

Böylece bir web server ayaklandırmış olduk. Rack anlatımı sizi kesmediyse ve rack ile daha fazla ne yapılabilir diye soruyorsanız [**bu kaynağa**](https://www.youtube.com/watch?v=MHYMObuEahc) gözatabilirsiniz.


### Peki nedir bu PUMA, Rack, WEBrick...
> https://www.justinweiss.com/articles/a-web-server-vs-an-app-server/



- **[Web Servers](https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_web_server):** Nginx and Apache

- **Application Servers:** Unicorn, Thin, Rainbows, WEBrick and [**Puma**](https://puma.io/)

- **[Rack](https://rack.github.io/):**  Rack tüm bunların dışında Application serverinizin rails projeniz ile anlaşabilmesini sağlayan bir aracı.

#### Peki bunlar nasıl çalışırlar?

Öncelikle yaptığımız istekler WebServer'a gider. Eğer yapılan istekler rails'ın halledebilceği istekler ise, Web server bu istekler üzerinde bir takım işlemler yapar ve istekleri Application server'a yönlendirir. Application server bu noktada rails uygulması ile konuşurken Rack'ı kullanır. Ardından rails'ın yapılan istek ile işi bittikten sonra Rails uygulaması app servere bir yanıt gönderir. O da bu yanıtı web server'a.

<p align="center">
	<img alt="rack-first-app" src="/img/day3/how-it-rails-servers-work.jpeg" width="500">
</p>

Genellikle Nginx isteğini Unicorn'a atar. Unicorn isteği rack'a iletir. Rails routerları arasından doğru controller bulunur ve yanıt bu sıra ile geri gönderilir.

---
## rbenv
> [github.com/rbenv](https://github.com/rbenv/rbenv)

Ruby versiyonlarınızı yönetmek için kullanacağınız bir araçtır.
rbenv ile bilgisayarınızda birden fazla ruby versiyonu barındırıp bu versiyonlar ile eş zamanlı çalışabilirsiniz.

`rbenv` her ruby versiyonunu diğer versiyonlardan ardındırılmış ortamlarda tutar bu sayede versiyonlar arası karışıklıkların önüne geçmiş olur.

Buna bir örnek:

- Diyelim ki şuan kullandığınız ruby versiyonu 2.5.1 ama siz 2.6.3 versiyonu indirip bu bu versiyona geçtiniz. Bu noktada yeni ruby versiyonunda bir önce kullandığınız ruby versiyonunda bulunan gemlerin olmadığını göreceksiniz. Ve kullanmak istediğiniz gem'leri bu ruby versiyonu için yeniden kurmanız gerekecek.

Öncelikle sisteminizde rbenv'in varlığını kontrol edelim. Bunun için:

```bash
$ rbenv -v
rbenv 1.1.1-39-g59785f6
```
> gibi bir çıktı alırsanız rbenv'yi tekaradan kurmanıza gerek yok. Sadece kullandığınız rbenv versiyonu eski ise bunu güncelleyebilirsiniz.

rbenvi güncellemek için:

```bash
cd /home/hasantezcan/.rbenv/plugins/ruby-build && git pull && cd -
```

> eğer rbenv sisteminizde yoksa nasıl kurulacağına [burdan](https://github.com/rbenv/rbenv#installation) bakabilirsiniz.

#### `rbenv` nasıl kullanılır?

- Sisteminize kurulu `rbenv` programının versiyonuna bakmak için:

```bash
$ rbenv -v
rbenv 1.1.1-39-g59785f6
```
- Sisteminizde yüklü olan ruby versiyonlarını görmek için:

```bash
$ rbenv versions
system
  2.3.0
  2.3.3
  2.4.6
  2.5.1
  2.5.3
* 2.6.3 (set by /home/hasantezcan/.rbenv/version)
```
- Şuan kulanmakta olduğunuz ruby versiyonunu görmek için:

```bash
$ rbenv version
2.6.3 (set by /home/hasantezcan/.rbenv/version)

# ya da

$ ruby -v
ruby 2.6.3p62 (2019-04-16 revision 67580) [x86_64-linux]
```
- Sisteme kurabilceğiniz ruby versionlarını görmek için:

```bash
$ rbenv install --list
  ...
  2.4.3
  2.4.4
  2.4.5
  2.4.6
  2.5.0-dev
  2.5.0-preview1
  2.5.0-rc1
  2.5.0
  2.5.1
  2.5.2
  2.5.3
  2.5.4
  2.5.5
  2.6.0-dev
  2.6.0-preview1
  2.6.0-preview2
  2.6.0-preview3
  2.6.0-rc1
  2.6.0-rc2
  2.6.0
  2.6.1
  2.6.2
  2.6.3
  ...
```
- Sisteme yeni bir ruby versiyonu ekleme:

```bash
$ rbenv install 2.6.3
```
- Sistemeden bir ruby versiyonu silmek için:

```bash
$ rbenv uninstall 2.6.3
```

#### Ruby versiyonları yönetmek:

##### `global`
>Global version numbers are stored in ~/.rbenv/version.

- Tüm sistem genelinde kullanılcak olan ruby versiyonunu seçerken:

```bash
$ rbenv global 2.6.3
```

- geri almak için

```bash
$ rbenv global --unset
```

##### `local`
> Application-specific version numbers are stored in .ruby-version.

- Çalıştığınız projede kullanılcak olan ruby versiyonunu seçerken:

```bash
$ rbenv local 2.6.3
```

- geri almak için

```bash
$ rbenv local --unset
```

##### `shell`
> Shell-local version numbers are stored as environment variables.

```bash
$ rbenv shell 2.6.3
```

- geri almak için

```bash
$ rbenv shell --unset
```

## Olası hatalar:

- **`rbenv version` ile `ruby -v version` farklı ise**

> bunu terminalden çalıştırın:

```bash
'echo 'eval "$(rbenv init -)"' >> ~/.zshrc'
```

---
## Utku Bayar ile görüntülü konuşma - 18.00
> Sınıf Sponsoru [buck.io](https://buck.ai/)'dan Utku Bayar ile görüntülü konuşma.

- Algortimalar bilginizi geliştirin.

- Matematik bilgisi (Lineer cebir, matrisler vb.)
	- Tüm makina öğrenmesi burdan geçiyor.

- Amerikaya gitsinenler startup kursunlar ve geri gelsinler diye [KOSGEB](www.kosgeb.gov.tr) para dağıtıyor. Kimsenin bundan haberi yok bu imkanları değerlendirin.

- **Siz yolda yürüyünce yol size görünür.** - *Mevlana*

<p align="center">
	<img alt="rack-first-app" src="/img/day3/buck-io.jpg" width="800">
</p>

---
